<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Daily Sunrise</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }

  @import url('https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;1,300&family=Inter:wght@300;400;500&display=swap');

  body {
    background: #0a0a12;
    color: #e0d0c0;
    font-family: 'Inter', sans-serif;
    min-height: 100vh;
    overflow-x: hidden;
  }

  .app {
    max-width: 900px;
    margin: 0 auto;
    padding: 40px 20px;
  }

  header {
    text-align: center;
    margin-bottom: 30px;
  }

  header h1 {
    font-family: 'Cormorant Garamond', serif;
    font-weight: 300;
    font-size: 2.4em;
    letter-spacing: 0.1em;
    color: #f0dcc0;
  }

  header .date {
    font-weight: 300;
    font-size: 0.95em;
    color: #8a7a6a;
    margin-top: 6px;
    letter-spacing: 0.05em;
  }

  .canvas-wrap {
    position: relative;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 20px 60px rgba(0,0,0,0.5), 0 0 80px rgba(255,140,50,0.08);
    margin-bottom: 30px;
  }

  canvas {
    display: block;
    width: 100%;
    height: auto;
  }

  .quote-box {
    text-align: center;
    padding: 20px 30px;
    margin-bottom: 35px;
  }

  .quote-text {
    font-family: 'Cormorant Garamond', serif;
    font-size: 1.5em;
    font-style: italic;
    font-weight: 300;
    color: #d4b896;
    line-height: 1.5;
  }

  .quote-attr {
    font-size: 0.85em;
    color: #7a6a5a;
    margin-top: 10px;
    letter-spacing: 0.04em;
  }

  .nav {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 20px;
    margin-bottom: 40px;
  }

  .nav button {
    background: rgba(255,255,255,0.06);
    border: 1px solid rgba(255,255,255,0.1);
    color: #c0b0a0;
    padding: 10px 22px;
    border-radius: 10px;
    cursor: pointer;
    font-family: 'Inter', sans-serif;
    font-size: 0.9em;
    font-weight: 400;
    transition: all 0.25s;
    letter-spacing: 0.03em;
  }

  .nav button:hover {
    background: rgba(255,255,255,0.12);
    border-color: rgba(255,200,120,0.3);
    color: #f0dcc0;
  }

  .nav button:disabled {
    opacity: 0.3;
    cursor: not-allowed;
  }

  .nav .day-label {
    font-weight: 300;
    font-size: 0.9em;
    color: #8a7a6a;
    min-width: 120px;
    text-align: center;
  }

  .btn-today {
    background: rgba(255,160,60,0.12) !important;
    border-color: rgba(255,160,60,0.25) !important;
    color: #e8c080 !important;
  }

  .divider {
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(255,200,120,0.15), transparent);
    margin: 10px 0 35px;
  }

  .gallery-title {
    font-family: 'Cormorant Garamond', serif;
    font-weight: 300;
    font-size: 1.3em;
    color: #a09080;
    text-align: center;
    margin-bottom: 20px;
    letter-spacing: 0.08em;
  }

  .gallery {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
    gap: 14px;
  }

  .gallery-item {
    cursor: pointer;
    border-radius: 10px;
    overflow: hidden;
    transition: all 0.3s;
    border: 2px solid transparent;
    background: rgba(255,255,255,0.03);
  }

  .gallery-item:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.4);
    border-color: rgba(255,160,60,0.3);
  }

  .gallery-item.active {
    border-color: rgba(255,160,60,0.5);
    box-shadow: 0 0 20px rgba(255,140,50,0.15);
  }

  .gallery-item canvas {
    width: 100%;
    height: auto;
    display: block;
  }

  .gallery-item .gallery-date {
    padding: 8px;
    font-size: 0.75em;
    color: #8a7a6a;
    text-align: center;
    font-weight: 300;
  }

  .empty-gallery {
    text-align: center;
    color: #5a4a3a;
    font-style: italic;
    font-size: 0.9em;
    padding: 30px;
  }

  .new-sunrise-btn {
    display: block;
    margin: 30px auto 0;
    background: linear-gradient(135deg, rgba(255,140,50,0.2), rgba(255,100,60,0.15));
    border: 1px solid rgba(255,140,50,0.25);
    color: #f0c880;
    padding: 14px 36px;
    border-radius: 12px;
    cursor: pointer;
    font-family: 'Inter', sans-serif;
    font-size: 1em;
    font-weight: 400;
    transition: all 0.3s;
    letter-spacing: 0.04em;
  }

  .new-sunrise-btn:hover {
    background: linear-gradient(135deg, rgba(255,140,50,0.35), rgba(255,100,60,0.25));
    box-shadow: 0 4px 20px rgba(255,140,50,0.15);
    transform: translateY(-1px);
  }
</style>
</head>
<body>
<div class="app">
  <header>
    <h1>Daily Sunrise</h1>
    <div class="date" id="currentDate"></div>
  </header>

  <div class="canvas-wrap">
    <canvas id="sunrise" width="860" height="400"></canvas>
  </div>

  <div class="quote-box">
    <div class="quote-text" id="quoteText"></div>
    <div class="quote-attr" id="quoteAttr"></div>
  </div>

  <div class="nav">
    <button id="prevBtn" onclick="navigate(-1)">&larr; Previous</button>
    <span class="day-label" id="dayLabel"></span>
    <button id="nextBtn" onclick="navigate(1)">Next &rarr;</button>
    <button class="btn-today" onclick="goToday()">Today</button>
  </div>

  <div class="divider"></div>

  <div class="gallery-title">Past Sunrises</div>
  <div class="gallery" id="gallery"></div>
  <div class="empty-gallery" id="emptyGallery" style="display:none;">
    Your sunrise collection will grow here, one day at a time.
  </div>
</div>

<script>
// --- Seeded PRNG (mulberry32) ---
function mulberry32(seed) {
  return function() {
    seed |= 0; seed = seed + 0x6D2B79F5 | 0;
    let t = Math.imul(seed ^ seed >>> 15, 1 | seed);
    t = t + Math.imul(t ^ t >>> 7, 61 | t) ^ t;
    return ((t ^ t >>> 14) >>> 0) / 4294967296;
  };
}

function dateToSeed(dateStr) {
  let h = 0;
  for (let i = 0; i < dateStr.length; i++) {
    h = ((h << 5) - h + dateStr.charCodeAt(i)) | 0;
  }
  return h;
}

// --- Quotes ---
const quotes = [
  { text: "There was never a night or a problem that could defeat sunrise or hope.", attr: "Bernard Williams" },
  { text: "Every sunrise is an invitation to brighten someone's day.", attr: "Richelle E. Goodrich" },
  { text: "The breeze at dawn has secrets to tell you. Don't go back to sleep.", attr: "Rumi" },
  { text: "Each morning we are born again. What we do today is what matters most.", attr: "Buddha" },
  { text: "Opportunities are like sunrises. If you wait too long, you miss them.", attr: "William Arthur Ward" },
  { text: "Every day is a renewal, every morning the daily miracle.", attr: "Gertrude Stein" },
  { text: "The sun does not shine for a few trees and flowers, but for the wide world's joy.", attr: "Henry Ward Beecher" },
  { text: "Rest but never quit. Even the sun has a sinking spell each evening. But it always rises the next morning.", attr: "Muhammad Ali" },
  { text: "I have always been delighted at the prospect of a new day, a fresh try, one more start.", attr: "Emily Dickinson" },
  { text: "With every sunrise, we start anew.", attr: "Unknown" },
  { text: "Dawn is the friend of the muses.", attr: "Latin Proverb" },
  { text: "There is a sunrise and a sunset every day, and they are absolutely free. Don't miss so many of them.", attr: "Jo Walton" },
  { text: "The sky takes on shades of orange during sunrise, the color used to paint the ceilings of old theaters.", attr: "Cy Twombly" },
  { text: "One day you will wake up and there won't be any more time to do the things you've always wanted. Do it now.", attr: "Paulo Coelho" },
  { text: "Tomorrow is the first blank page of a 365-page book. Write a good one.", attr: "Brad Paisley" },
  { text: "How wonderful it is that nobody need wait a single moment before starting to improve the world.", attr: "Anne Frank" },
  { text: "In the midst of winter, I found there was, within me, an invincible summer.", attr: "Albert Camus" },
  { text: "Not all those who wander are lost.", attr: "J.R.R. Tolkien" },
  { text: "The world is new each morning â€” that is God's gift, and every man should believe he is reborn each day.", attr: "Baal Shem Tov" },
  { text: "Light tomorrow with today.", attr: "Elizabeth Barrett Browning" },
  { text: "And still, after all this time, the sun has never said to the earth, 'You owe me.' Look what happens with a love like that. It lights up the whole sky.", attr: "Hafiz" },
  { text: "Nothing can dim the light which shines from within.", attr: "Maya Angelou" },
  { text: "This is a wonderful day. I've never seen this one before.", attr: "Maya Angelou" },
  { text: "Dwell on the beauty of life. Watch the stars, and see yourself running with them.", attr: "Marcus Aurelius" },
  { text: "Be willing to be a beginner every single morning.", attr: "Meister Eckhart" },
];

// --- Color helpers ---
function lerp(a, b, t) { return Math.round(a + (b - a) * t); }
function lerpColor(c1, c2, t) {
  return [lerp(c1[0], c2[0], t), lerp(c1[1], c2[1], t), lerp(c1[2], c2[2], t)];
}
function toCSS(c) { return `rgb(${c[0]},${c[1]},${c[2]})`; }

// --- Palettes ---
const palettes = [
  { top: [10,10,45], mid: [60,30,80], horizon: [255,140,50], sun: [255,220,80], land: [20,40,15], land2: [30,60,25] },
  { top: [5,5,30], mid: [100,40,70], horizon: [255,100,60], sun: [255,200,100], land: [25,35,20], land2: [35,55,30] },
  { top: [15,10,50], mid: [80,50,100], horizon: [255,170,80], sun: [255,240,150], land: [15,30,15], land2: [25,50,20] },
  { top: [20,5,40], mid: [140,50,60], horizon: [255,120,40], sun: [255,180,60], land: [30,25,15], land2: [45,40,20] },
  { top: [8,12,35], mid: [50,40,90], horizon: [240,160,80], sun: [255,230,120], land: [18,35,18], land2: [28,55,28] },
  { top: [12,8,42], mid: [120,30,60], horizon: [255,90,45], sun: [255,190,70], land: [22,30,12], land2: [38,45,22] },
  { top: [5,15,40], mid: [70,60,110], horizon: [220,150,90], sun: [255,210,130], land: [12,28,18], land2: [22,48,28] },
];

function skyColor(row, rows, pal) {
  const t = row / rows;
  if (t < 0.3) return lerpColor(pal.top, pal.mid, t / 0.3);
  return lerpColor(pal.mid, pal.horizon, (t - 0.3) / 0.7);
}

function midpointDisplacement(width, roughness, rng) {
  let n = 1;
  while (n < width) n *= 2;
  const h = new Float32Array(n + 1);
  h[0] = rng() * 0.4 + 0.3;
  h[n] = rng() * 0.4 + 0.3;
  let step = n, scale = roughness;
  while (step > 1) {
    const half = step >> 1;
    for (let i = half; i < n; i += step)
      h[i] = (h[i - half] + h[i + half]) / 2 + (rng() - 0.5) * 2 * scale;
    scale *= 0.5;
    step = half;
  }
  return Array.from(h).slice(0, width).map(v => Math.max(0, Math.min(1, v)));
}

function generateClouds(w, h, rng) {
  const clouds = Array.from({length: h}, () => new Uint8Array(w));
  const n = Math.floor(rng() * 5) + 2;
  for (let i = 0; i < n; i++) {
    const cx = Math.floor(rng() * w);
    const cy = Math.floor(rng() * (h * 0.5)) + 1;
    const cw = Math.floor(rng() * 12) + 4;
    const ch = Math.floor(rng() * 3) + 1;
    for (let dy = -ch; dy <= ch; dy++) {
      for (let dx = -cw; dx <= cw; dx++) {
        const nx = cx + dx, ny = cy + dy;
        if (nx >= 0 && nx < w && ny >= 0 && ny < h) {
          const dist = (dx/cw)**2 + (dy/ch)**2;
          if (dist < 1 && rng() > dist * 0.6) clouds[ny][nx] = 1;
        }
      }
    }
  }
  return clouds;
}

function generateStars(w, h, rng) {
  const stars = [];
  const n = Math.floor(rng() * 15) + 5;
  for (let i = 0; i < n; i++) {
    stars.push([Math.floor(rng() * w), Math.floor(rng() * (h * 0.45))]);
  }
  return stars;
}

// --- Render sunrise onto a canvas ---
function renderSunrise(canvas, dateStr) {
  const rng = mulberry32(dateToSeed(dateStr));
  const ctx = canvas.getContext('2d');
  const W = canvas.width, H = canvas.height;
  const skyRows = Math.floor(H * 0.77);
  const landRows = H - skyRows;
  const pal = palettes[Math.floor(rng() * palettes.length)];

  const sunX = Math.floor(rng() * (W * 0.5)) + Math.floor(W * 0.25);
  const sunY = skyRows - Math.floor(rng() * 5 + 3) * (H / 100);
  const sunRadius = W * 0.09;

  const clouds = generateClouds(W, skyRows, rng);
  const terrain1 = midpointDisplacement(W, 0.4, rng);
  const terrain2 = midpointDisplacement(W, 0.3, rng);
  const stars = generateStars(W, skyRows, rng);

  const imgData = ctx.createImageData(W, H);
  const d = imgData.data;

  for (let y = 0; y < skyRows; y++) {
    for (let x = 0; x < W; x++) {
      let c = skyColor(y, skyRows, pal);

      // Sun glow
      const dist = Math.sqrt((x - sunX)**2 + (y - sunY)**2);
      const glow = dist < sunRadius ? Math.max(0, 1 - dist / sunRadius) : 0;
      c = lerpColor(c, pal.sun, glow * 0.7);

      // Sun disc
      if (dist < sunRadius * 0.3) {
        const inner = 1 - dist / (sunRadius * 0.3);
        c = lerpColor(c, [255, 255, 230], inner * 0.9 + 0.1);
      }

      // Clouds
      if (clouds[y] && clouds[y][x]) {
        c = [Math.min(255, c[0]+60), Math.min(255, c[1]+50), Math.min(255, c[2]+40)];
      }

      const idx = (y * W + x) * 4;
      d[idx] = c[0]; d[idx+1] = c[1]; d[idx+2] = c[2]; d[idx+3] = 255;
    }
  }

  // Stars (drawn as bright pixels)
  for (const [sx, sy] of stars) {
    const dist = Math.sqrt((sx - sunX)**2 + (sy - sunY)**2);
    if (dist > sunRadius * 1.5) {
      const idx = (sy * W + sx) * 4;
      const brightness = 150 + Math.floor(rng() * 80);
      d[idx] = brightness; d[idx+1] = brightness; d[idx+2] = brightness + 20;
    }
  }

  // Terrain
  for (let y = 0; y < landRows; y++) {
    const t = y / landRows;
    for (let x = 0; x < W; x++) {
      const h1 = terrain1[x] * landRows * 0.6;
      const h2 = terrain2[x] * landRows * 0.85;
      let c;
      if (y < h1) {
        c = [lerp(pal.land2[0], pal.land2[0]+15, t),
             lerp(pal.land2[1], pal.land2[1]+10, t),
             lerp(pal.land2[2], pal.land2[2]+5, t)];
      } else if (y < h2) {
        c = [lerp(pal.land[0], pal.land[0]+10, t),
             lerp(pal.land[1], pal.land[1]+15, t),
             lerp(pal.land[2], pal.land[2]+5, t)];
      } else {
        const hc = skyColor(skyRows - 1, skyRows, pal);
        c = lerpColor(pal.land, hc, 0.3);
      }
      // Add subtle texture
      const noise = (rng() - 0.5) * 6;
      c = [Math.max(0, Math.min(255, c[0]+noise)),
           Math.max(0, Math.min(255, c[1]+noise)),
           Math.max(0, Math.min(255, c[2]+noise))];

      const idx = ((skyRows + y) * W + x) * 4;
      d[idx] = c[0]; d[idx+1] = c[1]; d[idx+2] = c[2]; d[idx+3] = 255;
    }
  }

  ctx.putImageData(imgData, 0, 0);

  // Sun glow overlay (smooth gradient circle)
  const grad = ctx.createRadialGradient(sunX, sunY, 0, sunX, sunY, sunRadius * 1.8);
  grad.addColorStop(0, `rgba(${pal.sun[0]},${pal.sun[1]},${pal.sun[2]},0.25)`);
  grad.addColorStop(0.3, `rgba(${pal.sun[0]},${pal.sun[1]},${pal.sun[2]},0.1)`);
  grad.addColorStop(1, 'rgba(0,0,0,0)');
  ctx.fillStyle = grad;
  ctx.fillRect(0, 0, W, H);

  // Horizon light band
  const hGrad = ctx.createLinearGradient(0, skyRows - 30, 0, skyRows + 10);
  hGrad.addColorStop(0, 'rgba(0,0,0,0)');
  hGrad.addColorStop(0.5, `rgba(${pal.horizon[0]},${pal.horizon[1]},${pal.horizon[2]},0.06)`);
  hGrad.addColorStop(1, 'rgba(0,0,0,0)');
  ctx.fillStyle = hGrad;
  ctx.fillRect(0, skyRows - 30, W, 40);
}

// --- Get quote for a date ---
function getQuote(dateStr) {
  const rng = mulberry32(dateToSeed(dateStr) + 9999);
  const idx = Math.floor(rng() * quotes.length);
  return quotes[idx];
}

// --- Date helpers ---
function formatDate(d) {
  return d.toISOString().split('T')[0];
}
function prettyDate(dateStr) {
  const d = new Date(dateStr + 'T12:00:00');
  return d.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
}
function addDays(dateStr, n) {
  const d = new Date(dateStr + 'T12:00:00');
  d.setDate(d.getDate() + n);
  return formatDate(d);
}

// --- Storage ---
function getHistory() {
  try { return JSON.parse(localStorage.getItem('sunrise_history') || '[]'); }
  catch { return []; }
}
function saveToHistory(dateStr) {
  const hist = getHistory();
  if (!hist.includes(dateStr)) {
    hist.push(dateStr);
    hist.sort().reverse();
    localStorage.setItem('sunrise_history', JSON.stringify(hist));
  }
}

// --- App state ---
const today = formatDate(new Date());
let currentDate = today;

function showSunrise(dateStr) {
  currentDate = dateStr;

  // Main canvas
  const canvas = document.getElementById('sunrise');
  renderSunrise(canvas, dateStr);

  // Quote
  const q = getQuote(dateStr);
  document.getElementById('quoteText').textContent = `"${q.text}"`;
  document.getElementById('quoteAttr').textContent = `- ${q.attr}`;

  // Header date
  document.getElementById('currentDate').textContent = prettyDate(dateStr);

  // Nav label
  if (dateStr === today) {
    document.getElementById('dayLabel').textContent = "Today";
  } else {
    const diff = Math.round((new Date(today+'T12:00:00') - new Date(dateStr+'T12:00:00')) / 86400000);
    document.getElementById('dayLabel').textContent = `${diff} day${diff !== 1 ? 's' : ''} ago`;
  }

  // Nav buttons
  document.getElementById('nextBtn').disabled = (dateStr === today);

  // Save to history
  saveToHistory(dateStr);

  // Refresh gallery
  renderGallery();
}

function navigate(dir) {
  const next = addDays(currentDate, dir);
  if (dir > 0 && next > today) return;
  showSunrise(next);
}

function goToday() {
  showSunrise(today);
}

function renderGallery() {
  const gallery = document.getElementById('gallery');
  const emptyMsg = document.getElementById('emptyGallery');
  const hist = getHistory().filter(d => d !== currentDate).slice(0, 12);

  if (hist.length === 0) {
    gallery.innerHTML = '';
    emptyMsg.style.display = 'block';
    return;
  }

  emptyMsg.style.display = 'none';
  gallery.innerHTML = '';

  for (const dateStr of hist) {
    const item = document.createElement('div');
    item.className = 'gallery-item';
    item.onclick = () => showSunrise(dateStr);

    const c = document.createElement('canvas');
    c.width = 200;
    c.height = 93;
    renderSunrise(c, dateStr);

    const label = document.createElement('div');
    label.className = 'gallery-date';
    const d = new Date(dateStr + 'T12:00:00');
    label.textContent = d.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });

    item.appendChild(c);
    item.appendChild(label);
    gallery.appendChild(item);
  }
}

// --- Init ---
showSunrise(today);
</script>
</body>
</html>
